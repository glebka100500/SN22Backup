<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_metadata_link">
    <sys_metadata_link action="INSERT_OR_UPDATE">
        <directory>update</directory>
        <documentkey>72bb5650673302008f87794717415aa0</documentkey>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;
    &lt;sys_script_include action="INSERT_OR_UPDATE"&gt;
        &lt;access&gt;package_private&lt;/access&gt;
        &lt;active&gt;true&lt;/active&gt;
        &lt;api_name&gt;global.ServiceCatalogGetLocation&lt;/api_name&gt;
        &lt;caller_access/&gt;
        &lt;client_callable&gt;true&lt;/client_callable&gt;
        &lt;description&gt;Used by set location client script to set the shipping address of the user. &lt;/description&gt;
        &lt;name&gt;ServiceCatalogGetLocation&lt;/name&gt;
        &lt;script&gt;&lt;![CDATA[var ServiceCatalogGetLocation = Class.create();
ServiceCatalogGetLocation.prototype = Object.extendsObject(AbstractAjaxProcessor, {

	_fetchAddressfromUserTable: function (sysId) {

		var address = '';

		var gr = new GlideRecord('sys_user');

		if(gr.get(sysId)) {

			if (gr.street != '' &amp;&amp; gr.street != null)
				address = gr.street + '\n';

			if (gr.city != '' &amp;&amp; gr.city != null)
				address += gr.city + ',';

			if (gr.state != '' &amp;&amp; gr.state != null)
				address += gr.state + ", ";

			if (gr.zip != '' &amp;&amp; gr.zip != null)
				address += gr.zip;

			if (gr.country != null &amp;&amp; gr.country != '') {
				address += '\n';
				address += gr.getDisplayValue('country');
			}

		}
		return address;
	},

	_fetchAddressfromCMNLocation: function(sysId) {

		var locationAddress = '';
		var location = new GlideRecord('cmn_location');

		if(location.get(sysId)) {

			if (location.street != null &amp;&amp; location.street != '')
				locationAddress += location.street + ", \n";

			if (location.city != null &amp;&amp; location.city != '')
				locationAddress += location.city + ", ";

			if (location.state != null &amp;&amp; location.state != '')
				locationAddress += location.state + ",";

			if (location.zip != null &amp;&amp; location.zip != '')
				locationAddress += location.zip;

			if (locationAddress.length &gt; 0)
				locationAddress += '\n';

			if (location.country != null &amp;&amp; location.country != '')
				locationAddress += location.country;

		}
		return locationAddress;
	},

	_getAddress: function(userSysId) {

		var useCmnLocation = gs.getProperty('glide.sc.prioritise.user.location');
		var gr = new GlideRecord('sys_user');

		if(gr.get(userSysId)) {

			var locId = gr.location;
			if (useCmnLocation === 'true' &amp;&amp; (locId != null &amp;&amp; locId != '' ))
				return this._fetchAddressfromCMNLocation(locId);

			if (gr.street != null &amp;&amp; gr.street != '')
				return this._fetchAddressfromUserTable(userSysId);

			if (useCmnLocation === 'false' &amp;&amp; (locId != null &amp;&amp; locId != ''))
				return this._fetchAddressfromCMNLocation(locId);

		}
		return null;
	},

	retrieveAddress: function() {

		var userShippingAddress = '';
		var userSysId = this.getParameter('sysparm_sysId');
		if (userSysId == '' || userSysId == null)
			return userShippingAddress;
		userShippingAddress = sn_sc.CartJS.getRequestedForAddress(userSysId);
		return userShippingAddress;
	},
	type: 'ServiceCatalogGetLocation'
});]]&gt;&lt;/script&gt;
        &lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;
        &lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;
        &lt;sys_created_on&gt;2015-11-14 09:24:07&lt;/sys_created_on&gt;
        &lt;sys_id&gt;72bb5650673302008f87794717415aa0&lt;/sys_id&gt;
        &lt;sys_mod_count&gt;16&lt;/sys_mod_count&gt;
        &lt;sys_name&gt;ServiceCatalogGetLocation&lt;/sys_name&gt;
        &lt;sys_package display_value="Service Catalog Platform" source="com.glideapp.servicecatalog.platform"&gt;6d218d0f6d2620100acb70b35343303c&lt;/sys_package&gt;
        &lt;sys_policy/&gt;
        &lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;
        &lt;sys_update_name&gt;sys_script_include_72bb5650673302008f87794717415aa0&lt;/sys_update_name&gt;
        &lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;
        &lt;sys_updated_on&gt;2017-07-13 19:31:13&lt;/sys_updated_on&gt;
        &lt;u_script_length&gt;2377&lt;/u_script_length&gt;
    &lt;/sys_script_include&gt;
&lt;/record_update&gt;
</payload>
        <sys_class_name>sys_metadata_link</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2022-12-19 20:28:28</sys_created_on>
        <sys_id>eacc053e2f331110d8a4d5f62799b632</sys_id>
        <sys_name>ServiceCatalogGetLocation</sys_name>
        <sys_package display_value="Integrations 2022" source="x_644088_integrati">4c7ca0582f0c9110d8a4d5f62799b66d</sys_package>
        <sys_policy/>
        <sys_scope display_value="Integrations 2022">4c7ca0582f0c9110d8a4d5f62799b66d</sys_scope>
        <sys_update_name>sys_metadata_link_eacc053e2f331110d8a4d5f62799b632</sys_update_name>
        <tablename>sys_script_include</tablename>
    </sys_metadata_link>
</record_update>
