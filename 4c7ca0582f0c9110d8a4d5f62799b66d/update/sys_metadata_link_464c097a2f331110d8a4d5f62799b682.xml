<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_metadata_link">
    <sys_metadata_link action="INSERT_OR_UPDATE">
        <directory>update</directory>
        <documentkey>1bf2207bb712230026778d78ee11a9f5</documentkey>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;
    &lt;sys_script_include action="INSERT_OR_UPDATE"&gt;
        &lt;access&gt;package_private&lt;/access&gt;
        &lt;active&gt;true&lt;/active&gt;
        &lt;api_name&gt;global.UpdateAllKnowledgeFullCategorySNC&lt;/api_name&gt;
        &lt;caller_access/&gt;
        &lt;client_callable&gt;false&lt;/client_callable&gt;
        &lt;description&gt;This script bulk updates the Full Category Names for each category based on the related category labels based on locale.  Customers should not change this class directly This class is never called directly.&lt;/description&gt;
        &lt;name&gt;UpdateAllKnowledgeFullCategorySNC&lt;/name&gt;
        &lt;script&gt;&lt;![CDATA[var UpdateAllKnowledgeFullCategorySNC = Class.create();
UpdateAllKnowledgeFullCategorySNC.prototype = {
    initialize: function() {
    },
	
	getAllLanguageCodes: function() {
		var languageList = new Array();
		var translationRecords = new GlideAggregate("sys_translated_text");
        translationRecords.addQuery("tablename", "kb_category");
		translationRecords.addQuery("fieldname", "label");
		translationRecords.groupBy("language");
		translationRecords.query();
		while(translationRecords.next()) {
			languageList.push(translationRecords.getValue("language") + '');
		}
		return languageList;
	},
	
	// Updates the Knowledge Full Category Display Value for all the Locales that have a Category Label translation.
    updateFullCategoryForAllLocale : function() {
		var allLanguageCodes = this.getAllLanguageCodes();
		for (var i = 0; i &lt; allLanguageCodes.length; i++) {
			this.updateFullCategoryForLocale(allLanguageCodes[i]);
		}			
    },
    
    // Updates the Knowledge Full Category Display Value for all the Locales that have a Category Label translation.
    updateFullCategoryForLocale : function(languageCode) {
		var knowHelp = new SNC.KnowledgeHelper();
		var topLevelCategoryRecords = new GlideRecord("kb_knowledge_base");
		topLevelCategoryRecords.query();
		while(topLevelCategoryRecords.next()) {
			knowHelp.setNestedCategories(topLevelCategoryRecords.getUniqueValue(), "", languageCode);
		}
    },
	
	// Updates the Knowledge Full Category Display Value for all the Locales that have a Category Label translation.
    updateFullCategoryForKnowledgeBase : function(knowledgeBaseId) {
		var success = true;
		var knowHelp = new SNC.KnowledgeHelper();
		var allLanguageCodes = this.getAllLanguageCodes();
		var gr_kb = new GlideRecord("kb_knowledge_base");
		
		if(!(gr_kb.get(knowledgeBaseId) &amp;&amp; gr_kb.canRead()))
			return false;
		
		for (var i = 0; i &lt; allLanguageCodes.length; i++) {
			result = knowHelp.setNestedCategories(knowledgeBaseId, "", allLanguageCodes[i]);
			if(!result)
				success = false;
		}
		return success;
    },

    type: 'UpdateAllKnowledgeFullCategorySNC'
};]]&gt;&lt;/script&gt;
        &lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;
        &lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;
        &lt;sys_created_on&gt;2018-12-17 09:07:30&lt;/sys_created_on&gt;
        &lt;sys_id&gt;1bf2207bb712230026778d78ee11a9f5&lt;/sys_id&gt;
        &lt;sys_mod_count&gt;2&lt;/sys_mod_count&gt;
        &lt;sys_name&gt;UpdateAllKnowledgeFullCategorySNC&lt;/sys_name&gt;
        &lt;sys_package display_value="Knowledge Management Core" source="com.glideapp.knowledge"&gt;e011410f6d2620100acb70b353433002&lt;/sys_package&gt;
        &lt;sys_policy&gt;read&lt;/sys_policy&gt;
        &lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;
        &lt;sys_update_name&gt;sys_script_include_1bf2207bb712230026778d78ee11a9f5&lt;/sys_update_name&gt;
        &lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;
        &lt;sys_updated_on&gt;2019-03-15 09:49:17&lt;/sys_updated_on&gt;
        &lt;u_script_length&gt;2114&lt;/u_script_length&gt;
    &lt;/sys_script_include&gt;
&lt;/record_update&gt;
</payload>
        <sys_class_name>sys_metadata_link</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2022-12-19 20:26:15</sys_created_on>
        <sys_id>464c097a2f331110d8a4d5f62799b682</sys_id>
        <sys_name>UpdateAllKnowledgeFullCategorySNC</sys_name>
        <sys_package display_value="Integrations 2022" source="x_644088_integrati">4c7ca0582f0c9110d8a4d5f62799b66d</sys_package>
        <sys_policy/>
        <sys_scope display_value="Integrations 2022">4c7ca0582f0c9110d8a4d5f62799b66d</sys_scope>
        <sys_update_name>sys_metadata_link_464c097a2f331110d8a4d5f62799b682</sys_update_name>
        <tablename>sys_script_include</tablename>
    </sys_metadata_link>
</record_update>
