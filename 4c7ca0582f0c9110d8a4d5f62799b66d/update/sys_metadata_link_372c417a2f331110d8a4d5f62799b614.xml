<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_metadata_link">
    <sys_metadata_link action="INSERT_OR_UPDATE">
        <directory>update</directory>
        <documentkey>05086ed3471331004695d7527c9a7194</documentkey>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;
    &lt;sys_script_include action="INSERT_OR_UPDATE"&gt;
        &lt;access&gt;package_private&lt;/access&gt;
        &lt;active&gt;true&lt;/active&gt;
        &lt;api_name&gt;global.ExportDefinitionHelper&lt;/api_name&gt;
        &lt;caller_access/&gt;
        &lt;client_callable&gt;true&lt;/client_callable&gt;
        &lt;description&gt;Helper for Export Definition&lt;/description&gt;
        &lt;name&gt;ExportDefinitionHelper&lt;/name&gt;
        &lt;script&gt;&lt;![CDATA[var ExportDefinitionHelper = Class.create();
ExportDefinitionHelper.prototype = Object.extendsObject(AbstractAjaxProcessor, {
    ED_VIEW_TEMP_PREFIX: "exp_dtmp",
    ED_VIEW_PREFIX: "exp_d",

    /*
     * Creates a ui view for Export Definition.
     *
     * Eg. for export definition sys_id='50eaa041478331004695d7527c9a7102' ,
     * view 'exp_d50eaa041478331004695d7527c9a7102' is created.
     *
     * exp_d is prefix for Export Definition view, followed by sys_id.
     */
    createViewED: function(ed_id, table_name, field_list) {
        var name = this.ED_VIEW_PREFIX + ed_id;
        var manager = new SNC.ExportDefinitionViewManager();
        var sysId = manager.createView(name, table_name, field_list);

        return sysId;
    },

    /*
     * Creates a temporary Export Definition view for current logged user,
     * created before changes to Export Definition is persisted.
     *
     * Eg. for incident table and user name = 'admin' , name of the temporary view created is 'exp_dtmpadminincident'.
     * exp_dtmp is prefix for temporary Export Definition view, incident is table name, admin is user_name.
     */
    createTmpViewED: function() {
        var name = this.ED_VIEW_TEMP_PREFIX + this.getParameter('sysparm_table_name') + gs.getUserName();
        var manager = new SNC.ExportDefinitionViewManager();
        var sysId = manager.createView(name, this.getParameter('sysparm_table_name'), this.getParameter('sysparm_field_list'));

        return name;
    },

    /*
     * Deletes all the temporary views for current logged user.
     */
    deleteTmpViewED: function() {
        var manager = new SNC.ExportDefinitionViewManager();

        var gr = new GlideRecord('sys_ui_view');
        gr.addQuery('name', 'ENDSWITH', gs.getUserName());
        gr.addQuery('name', 'CONTAINS', this.EXPORT_DEF_VIEW_TEMP_PREFIX);
        gr.query();

        while (gr.next()) {
            manager.deleteView(gr.getValue('name'));
        }
    },

    /*
     *	Get list of fields for a view,  sysparm_view_name, on a table, sysparm_table_name.
     *  params , sysparm_view_name , sysparm_table_name
     *
     *  For calling from client side scripts.
     */
    getFieldsCS: function() {
        var viewName = this.getParameter('sysparm_view_name');
        var tableName = this.getParameter('sysparm_table_name');

        var fieldsString = this.getFields(tableName, viewName).toString();
        return fieldsString;
    },

    /*
     *	Get list of fields for a view,  view_name, on a table, table_name.
     *
     *  For calling from server side scripts.
     */
    getFields: function(table_name, view_name) {
        //sys_id of default view is 'Default View'
        var viewSysId = "Default View";
        if (GlideStringUtil.notNil(view_name))
            viewSysId = this._getViewId(view_name);

        var uiListGR = new GlideRecord('sys_ui_list');
        uiListGR.addQuery('name', table_name);
        uiListGR.addQuery('view', viewSysId);
        uiListGR.query();
        uiListGR.next();
        var uiListSysId = uiListGR.sys_id;

        var uiListElemGR = new GlideRecord('sys_ui_list_element');
        uiListElemGR.addQuery('list_id', uiListSysId);
        uiListElemGR.query();

        var elems = [];
        while (uiListElemGR.next()) {
            elems.push(uiListElemGR.getValue('element'));
        }
        return elems;
    },

    _getViewId: function(view_name) {
        var uiViewGR = new GlideRecord('sys_ui_view');
        uiViewGR.addQuery('name', view_name);
        uiViewGR.query();
        uiViewGR.next();
        return uiViewGR.sys_id;
    },
    type: 'ExportDefinitionHelper'
});
]]&gt;&lt;/script&gt;
        &lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;
        &lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;
        &lt;sys_created_on&gt;2015-04-14 01:17:06&lt;/sys_created_on&gt;
        &lt;sys_id&gt;05086ed3471331004695d7527c9a7194&lt;/sys_id&gt;
        &lt;sys_mod_count&gt;3&lt;/sys_mod_count&gt;
        &lt;sys_name&gt;ExportDefinitionHelper&lt;/sys_name&gt;
        &lt;sys_package display_value="Basic Export Set Functionality" source="com.glide.system_export_set"&gt;e9c185436d6620100acb70b3534330ab&lt;/sys_package&gt;
        &lt;sys_policy/&gt;
        &lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;
        &lt;sys_update_name&gt;sys_script_include_05086ed3471331004695d7527c9a7194&lt;/sys_update_name&gt;
        &lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;
        &lt;sys_updated_on&gt;2015-04-14 01:45:03&lt;/sys_updated_on&gt;
        &lt;u_script_length&gt;3669&lt;/u_script_length&gt;
    &lt;/sys_script_include&gt;
&lt;/record_update&gt;
</payload>
        <sys_class_name>sys_metadata_link</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2022-12-19 20:25:49</sys_created_on>
        <sys_id>372c417a2f331110d8a4d5f62799b614</sys_id>
        <sys_name>ExportDefinitionHelper</sys_name>
        <sys_package display_value="Integrations 2022" source="x_644088_integrati">4c7ca0582f0c9110d8a4d5f62799b66d</sys_package>
        <sys_policy/>
        <sys_scope display_value="Integrations 2022">4c7ca0582f0c9110d8a4d5f62799b66d</sys_scope>
        <sys_update_name>sys_metadata_link_372c417a2f331110d8a4d5f62799b614</sys_update_name>
        <tablename>sys_script_include</tablename>
    </sys_metadata_link>
</record_update>
