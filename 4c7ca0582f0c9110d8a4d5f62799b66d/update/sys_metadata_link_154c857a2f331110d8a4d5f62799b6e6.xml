<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_metadata_link">
    <sys_metadata_link action="INSERT_OR_UPDATE">
        <directory>update</directory>
        <documentkey>19b70b6537330200455726877e41f1d7</documentkey>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;
    &lt;sys_script_include action="INSERT_OR_UPDATE"&gt;
        &lt;access&gt;public&lt;/access&gt;
        &lt;active&gt;true&lt;/active&gt;
        &lt;api_name&gt;global.CustomConsoleAjax&lt;/api_name&gt;
        &lt;caller_access/&gt;
        &lt;client_callable&gt;true&lt;/client_callable&gt;
        &lt;description&gt;Ajax utility to create custom planned task consoles&lt;/description&gt;
        &lt;name&gt;CustomConsoleAjax&lt;/name&gt;
        &lt;script&gt;&lt;![CDATA[var CustomConsoleAjax = Class.create();
CustomConsoleAjax.prototype = Object.extendsObject(AbstractAjaxProcessor, {
    
    createConsole: function() {
        var table = this.getParameter('sysparm_table');
        var filter = this.getParameter('sysparm_filter');
        var filterName = this.getParameter('sysparm_filter_name');
        var owner = gs.getUser().getID();
        var gr = new GlideRecordSecure('planned_task_custom_console');
        gr.addQuery('table', table);
        if ( JSUtil.nil(filter) ) {
			filter = this.correctEmptyFilter(filter, table);
			gr.addQuery('filter',filter);
		}
        else
            gr.addQuery('filter', filter);
        gr.addQuery('owner', owner);
        gr.query();
        if ( gr.next() ) 
            return gr.getValue('sys_id');
        filter = this.correctEmptyFilter(filter, table);
        gr.initialize();
        var sourceTable = new GlideRecord(table);
        gr.name = filterName || gs.getMessage("My Gantt");
        gr.table = table;
        gr.filter = filter;
        gr.owner = owner;
        var id = gr.insert();
        return id;
    },
    
    editConsole : function() {
        var sysId = this.getParameter('sysparm_sys_id');
        var table = this.getParameter('sysparm_table');
        var filter = this.getParameter('sysparm_filter');
        filter = this.correctEmptyFilter(filter, table);
        var filterName = this.getParameter('sysparm_filter_name');
        var gr = new GlideRecordSecure('planned_task_custom_console');
        if(gr.get(sysId)) {
            gr.name = filterName;
            gr.table = table;
            gr.filter = filter;
            var id = gr.update();
            return id;
        }
            
    },
    
    deleteConsole: function() {
        var sysId = this.getParameter('sysparm_sys_id');
        var gr = new GlideRecordSecure('planned_task_custom_console');
        var isDeleted = false;
        if(gr.get(sysId)) 
            isDeleted = gr.deleteRecord();
        return isDeleted;
    },

    correctEmptyFilter: function (filter, table) {
        if(!filter || JSUtil.nil(filter)) {
            return 'sys_class_name=' + table;
        }
        return filter;
    },

    type: 'CustomConsoleAjax'
});]]&gt;&lt;/script&gt;
        &lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;
        &lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;
        &lt;sys_created_on&gt;2015-11-18 09:48:06&lt;/sys_created_on&gt;
        &lt;sys_id&gt;19b70b6537330200455726877e41f1d7&lt;/sys_id&gt;
        &lt;sys_mod_count&gt;22&lt;/sys_mod_count&gt;
        &lt;sys_name&gt;CustomConsoleAjax&lt;/sys_name&gt;
        &lt;sys_package display_value="Planned Task_v2" source="com.snc.planned_task_v2"&gt;e93557642fc10110d8a4d5f62799b623&lt;/sys_package&gt;
        &lt;sys_policy/&gt;
        &lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;
        &lt;sys_update_name&gt;sys_script_include_19b70b6537330200455726877e41f1d7&lt;/sys_update_name&gt;
        &lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;
        &lt;sys_updated_on&gt;2017-09-20 13:40:28&lt;/sys_updated_on&gt;
        &lt;u_script_length&gt;2245&lt;/u_script_length&gt;
    &lt;/sys_script_include&gt;
&lt;/record_update&gt;
</payload>
        <sys_class_name>sys_metadata_link</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2022-12-19 20:26:12</sys_created_on>
        <sys_id>154c857a2f331110d8a4d5f62799b6e6</sys_id>
        <sys_name>CustomConsoleAjax</sys_name>
        <sys_package display_value="Integrations 2022" source="x_644088_integrati">4c7ca0582f0c9110d8a4d5f62799b66d</sys_package>
        <sys_policy/>
        <sys_scope display_value="Integrations 2022">4c7ca0582f0c9110d8a4d5f62799b66d</sys_scope>
        <sys_update_name>sys_metadata_link_154c857a2f331110d8a4d5f62799b6e6</sys_update_name>
        <tablename>sys_script_include</tablename>
    </sys_metadata_link>
</record_update>
