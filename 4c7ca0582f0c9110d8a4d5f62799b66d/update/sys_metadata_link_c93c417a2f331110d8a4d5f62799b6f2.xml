<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_metadata_link">
    <sys_metadata_link action="INSERT_OR_UPDATE">
        <directory>update</directory>
        <documentkey>0944d627c3202200b6dcdfdc64d3aebb</documentkey>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;
    &lt;sys_script_include action="INSERT_OR_UPDATE"&gt;
        &lt;access&gt;public&lt;/access&gt;
        &lt;active&gt;true&lt;/active&gt;
        &lt;api_name&gt;global.ICalUtilSNC&lt;/api_name&gt;
        &lt;caller_access/&gt;
        &lt;client_callable&gt;false&lt;/client_callable&gt;
        &lt;description/&gt;
        &lt;name&gt;ICalUtilSNC&lt;/name&gt;
        &lt;script&gt;&lt;![CDATA[var ICalUtilSNC = Class.create();

ICalUtilSNC.PREAMBLE = [
	"VERSION:2.0",
	"PRODID:-//Service-now.com//Outlook 11.0 MIMEDIR//EN",
	"METHOD:PUBLISH"
];

ICalUtilSNC.ALARM = [
	"BEGIN:VALARM",
	"TRIGGER:-PT30M",
	"REPEAT:2",
	"DURATION:PT15M",
	"ACTION:DISPLAY",
	"END:VALARM"
];

ICalUtilSNC.BYDAY = {
	daily : "MO,TU,WE,TH,FR,SA,SU",
	weekdays : "MO,TU,WE,TH,FR",
	weekends : "SA,SU",
	weekMWF : "MO,WE,FR",
	weekTT : "TU,TH"
};

ICalUtilSNC.FREQ = "WEEKLY";

ICalUtilSNC.MULTIPLE = 7;

ICalUtilSNC.DAYS = {
	1 : "MO",
	2 : "TU",
	3 : "WE",
	4 : "TH",
	5 : "FR",
	6 : "SA",
	7 : "SU"
};

ICalUtilSNC.BEGIN_CAL = "BEGIN:VCALENDAR";
ICalUtilSNC.END_CAL = "END:VCALENDAR";
ICalUtilSNC.BEGIN_EVENT = "BEGIN:VEVENT";
ICalUtilSNC.END_EVENT = "END:VEVENT";
ICalUtilSNC.SEQUENCE = "SEQUENCE:1";
ICalUtilSNC.STATUS = "X-MICROSOFT-CDO-BUSYSTATUS:FREE";
ICalUtilSNC.SHOW_AS = "TRANSP:TRANSPARENT";

ICalUtilSNC.prototype = {

    initialize: function() {
    },

	formatRecurringRule: function(ruleObj) {
		var rule = "RRULE:";
		if (ruleObj.FREQ)
			rule += "FREQ=" + ruleObj.FREQ + ";";
		if (ruleObj.INTERVAL)
			rule += "INTERVAL=" + ruleObj.INTERVAL + ";";
		if (ruleObj.BYDAY)
			rule += "BYDAY=" + ruleObj.BYDAY + ";";
		if (ruleObj.WKST)
			rule += "WKST=" + ruleObj.WKST + ";";
		if (ruleObj.UNTIL)
			rule += "UNTIL=" + ruleObj.UNTIL + ";";
		return rule;
	},

	formatICalEvent: function(arrEvent, useAlarm) {
		var iCalEvent = [
			ICalUtilSNC.BEGIN_EVENT,
			ICalUtilSNC.SEQUENCE
		];
		iCalEvent = iCalEvent.concat(arrEvent);
		iCalEvent.push(ICalUtilSNC.SHOW_AS);
		iCalEvent.push(ICalUtilSNC.STATUS);
		if (useAlarm)
			iCalEvent = iCalEvent.concat(ICalUtilSNC.ALARM);
		iCalEvent.push(ICalUtilSNC.END_EVENT);
		return iCalEvent.join("\n");
	},
	
	formatICalComponent: function(arrEvents) {
		var eventCalendar = [
			ICalUtilSNC.BEGIN_CAL,
			ICalUtilSNC.PREAMBLE.join("\n")
		];
		eventCalendar = eventCalendar.concat(arrEvents);
		eventCalendar.push(ICalUtilSNC.END_CAL);
		return eventCalendar;
	},

	getSDT: function(sdtStr, timeZone) {
		var scheduleDateTime = new GlideScheduleDateTime();

		scheduleDateTime.setValue(sdtStr);
		if (!(sdtStr.slice(-1) === "Z" || JSUtil.nil(timeZone))) {
			scheduleDateTime.setTimeZone(timeZone);
			scheduleDateTime.setTimeZone("Etc/UTC");
		}

		return scheduleDateTime;
	},

	getDateFromScheduleDateTime: function(scheduleDateTime) {
		var date = scheduleDateTime.getValue();
		if (!JSUtil.nil(date))
			return date.split("T")[0];
		return "";
	},

	getTimeFromScheduleDateTime: function(scheduleDateTime) {
		var date = scheduleDateTime.getValue();
		if (!JSUtil.nil(date))
			return date.split("T")[1];
		return "";
	},

    type: 'ICalUtilSNC'
};]]&gt;&lt;/script&gt;
        &lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;
        &lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;
        &lt;sys_created_on&gt;2016-07-17 14:10:49&lt;/sys_created_on&gt;
        &lt;sys_id&gt;0944d627c3202200b6dcdfdc64d3aebb&lt;/sys_id&gt;
        &lt;sys_mod_count&gt;10&lt;/sys_mod_count&gt;
        &lt;sys_name&gt;ICalUtilSNC&lt;/sys_name&gt;
        &lt;sys_package display_value="On-Call Scheduling" source="com.snc.on_call_rotation"&gt;37d4c9836de620100acb70b3534330d3&lt;/sys_package&gt;
        &lt;sys_policy&gt;read&lt;/sys_policy&gt;
        &lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;
        &lt;sys_update_name&gt;sys_script_include_0944d627c3202200b6dcdfdc64d3aebb&lt;/sys_update_name&gt;
        &lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;
        &lt;sys_updated_on&gt;2021-04-07 08:05:51&lt;/sys_updated_on&gt;
        &lt;u_script_length&gt;2699&lt;/u_script_length&gt;
    &lt;/sys_script_include&gt;
&lt;/record_update&gt;
</payload>
        <sys_class_name>sys_metadata_link</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2022-12-19 20:25:54</sys_created_on>
        <sys_id>c93c417a2f331110d8a4d5f62799b6f2</sys_id>
        <sys_name>ICalUtilSNC</sys_name>
        <sys_package display_value="Integrations 2022" source="x_644088_integrati">4c7ca0582f0c9110d8a4d5f62799b66d</sys_package>
        <sys_policy/>
        <sys_scope display_value="Integrations 2022">4c7ca0582f0c9110d8a4d5f62799b66d</sys_scope>
        <sys_update_name>sys_metadata_link_c93c417a2f331110d8a4d5f62799b6f2</sys_update_name>
        <tablename>sys_script_include</tablename>
    </sys_metadata_link>
</record_update>
